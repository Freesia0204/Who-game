<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>AI 房間</title>
  <!-- 引入CSS樣式表 -->
  <link rel="stylesheet" href="AI_room.css">
  <link rel="stylesheet" href="click-effect.css">
</head>
<body>
  <!-- 導覽列 -->
  <header class="navbar">
    <nav>
      <!-- 左側導覽連結 -->
      <div class="nav-links">
        <!-- 遊戲玩法按鈕 -->
        <a href="#" id="openRules2">遊戲玩法</a> 
        <!-- 人物查詢按鈕 -->
        <a href="#" id="openQueryModal">人物查詢</a>
        <!-- 題庫按鈕 (使用onclick直接呼叫JavaScript函數) -->
        <a href="#" onclick="showQuestionBank()">題庫</a>
        <!-- 退出遊戲按鈕 (返回首頁) -->
        <a href="index.html">退出遊戲</a>
      </div>
      <!-- 右側房間資訊 -->
      <div class="room-info">
        模式：AI模式　<!-- 顯示遊戲模式 -->
        玩家：<span id="playerNameText"></span>　<!-- 動態顯示玩家名稱 -->
        對手：AI <!-- 顯示對手類型 -->
      </div>
    </nav>
  </header>

  <!-- 房間主要容器 -->
  <div class="container">
    <!-- 左邊格子區 (用於顯示主題和角色卡片) -->
    <div class="grid-area"></div>
    <div class="left-decoration"></div>

    <!-- 右邊聊天區 -->
    <div class="chat-area">
      <div class="status">系統訊息</div>
      <!-- 訊息顯示區域 -->
      <ul class="messages" id="messages">
        <!-- 初始歡迎訊息 -->
        <li class="message system">歡迎進入房間！</li>
      </ul>

      <!-- 聊天輸入表單 -->
      <form id="chatForm" class="chat-form">
        <!-- 文字輸入框 -->
        <input type="text" id="chatInput" placeholder="輸入訊息...">
        <!-- 送出按鈕 -->
        <button type="submit">送出</button>
      </form>
      <!-- 猜格子按鈕區域 -->
      <div class="guess-container">
        <!-- 「我要猜」按鈕 (初始隱藏) -->
        <button id="guessBtn">我要猜</button>
        <!-- 「取消猜」按鈕 (初始隱藏) -->
        <button id="cancelGuessBtn" style="display:none;">取消猜</button>
      </div>
    </div>

    <!-- 遊戲開始規則彈窗 -->
    <div class="modal" id="rulesModal">
      <div class="modal-content">
        <h3>遊戲玩法</h3>
        <!-- 遊戲規則說明 -->
        <p>1. 開始遊戲後請點擊格子選擇主題和自己的卡牌。</p>
        <p>2. 選擇好卡牌後，系統將自動猜拳決定先手，贏的可以先問問題。</p>
        <p>3. 玩法為互相提問，猜對方所選中的卡牌。</p>
        <p>4. 需要先問三個問題後，才能猜對方的卡牌；猜錯則需再問一個問題才能再猜。</p>
        <p>5. 人物形象以圖片為主。</p>
        <p>6. 卡牌選擇完後，點擊左邊格子可產生遮罩，以供排除。</p>
        <!-- 開始遊戲按鈕 -->
        <button id="startBtn">開始遊戲</button>
      </div>
    </div>

    <!-- 導覽列的規則彈窗 (從導覽列開啟) -->
    <div class="modal" id="rulesModal2" style="display:none;">
      <div class="modal-content">
        <!-- 關閉按鈕 (叉叉符號) -->
        <span class="close" id="closeRules2">&times;</span>
        <h3>遊戲玩法</h3>
        <!-- 遊戲規則說明 (與上方規則相同) -->
        <p>1. 開始遊戲後請點擊格子選擇主題和自己的卡牌。</p>
        <p>2. 選擇好卡牌後，系統將自動猜拳決定先手，贏的可以先問問題。</p>
        <p>3. 玩法為互相提問，猜對方所選中的卡牌。</p>
        <p>4. 需要先問三個問題後，才能猜對方的卡牌；猜錯則需再問一個問題才能再猜。</p>
        <p>5. 人物形象以圖片為主。</p>
        <p>6. 卡牌選擇完後，點擊左邊格子可產生遮罩，以供排除。</p>
      </div>
    </div>

    <!-- 遊戲結束彈窗 (遊戲結束時顯示) -->
    <div id="endModal" class="modal" style="display:none;">
      <div class="modal-content">
        <!-- 遊戲結果標題 -->
        <h2 id="endResultText"></h2>
        <!-- 玩家和AI的選擇顯示 -->
        <p id="endChoicesText"></p>
        <div class="modal-buttons">
          <!-- 返回首頁按鈕 -->
          <a href="index.html" class="btn">回首頁</a>
          <!-- 重新開始按鈕 -->
          <a href="AI_room.html" class="btn">再來一次</a>
          <!-- 查看AI推理紀錄按鈕 (在新視窗開啟) -->
          <button onclick="window.open('AI_Debug.html', '_blank')">查看 AI 推理紀錄</button>
        </div>
      </div>
    </div>

    <!-- 人物查詢 Modal (用於查詢角色特性) -->
    <div id="characterQueryModal" class="modal">
      <div class="modal-content" style="max-height: 85vh; overflow-y: auto; position: relative;">
        <!-- 關閉按鈕 -->
        <span class="close" id="closeQueryModal" style="position: sticky; top: 0; float: right; cursor: pointer; font-size: 28px;">&times;</span>
        
        <h3>人物查詢</h3>
        <!-- 查詢輸入框 -->
        <input type="text" id="queryInput" placeholder="請輸入描述關鍵字...">
        <!-- 查詢按鈕 -->
        <button id="queryBtn">查詢</button>
        <!-- 查詢結果顯示區域 -->
        <div id="queryResult"></div>
      </div>
    </div>

    <!-- 題庫 Modal (顯示推薦提問問題) -->
    <div id="question-bank-modal" class="modal" style="display:none;">
      <div class="modal-content" style="max-height: 80vh; overflow-y: auto; position: relative;">
        <!-- 關閉按鈕 -->
        <span class="close" onclick="closeQuestionBank()" style="position: sticky; top: 0; float: right; cursor: pointer; font-size: 28px;">&times;</span>
        
        <!-- 標題 (會動態顯示當前主題) -->
        <h3 id="question-bank-title">可用提問</h3>
        <!-- 使用說明 -->
        <p style="font-size: 0.9em; color: #666;">點擊問題即可自動複製</p>
        <hr>
        <!-- 問題列表容器 -->
        <div id="question-list-container">
          <!-- 問題列表會動態生成在此 -->
        </div>
      </div>
    </div>

    <!-- 複製成功提示框 (用於顯示複製到剪貼簿的提示) -->
    <div id="copy-toast" style="display:none; position:fixed; top:20px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.7); color:white; padding:10px 20px; border-radius:20px; z-index:10000;">
      已複製到剪貼簿！
    </div>

  <!-- 引入JavaScript檔案 -->
  <!-- 主遊戲邏輯 -->
  <script src="AI_room.js"></script>
  <!-- 點擊特效功能 -->
  <script src="click-effect.js"></script>
</body>
</html>